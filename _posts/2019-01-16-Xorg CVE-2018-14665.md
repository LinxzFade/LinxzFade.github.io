---
layout: post
title:  "Xorg CVE2018-14665"
categories: [Vulnerabilities]
tags: [priv esc, exploit]
draft: true
---

### Introduction

On October 25th 2018 a [post](https://securitytracker.com/id/1041948) was made on SecurityTracker disclosing CVE2018-14665. The interesting thing is this CVE has two bugs in two different arguments. The first is a flaw in the `-modulepath` argument which could lead to arbitary code being executed on the system. The second was a flaw in the `-logfile` arugment which could allowed arbitary files to be deleted on the system, both of these issues were caused by poor command line validation.

### So, how does it work?

It is worth noting that the reason this can be used for privlege escalation is because both of these processes are root processes meaning when they are run they will run as root, this is why it is possible for us to gain root access, the problem was that the program was not correctly checking whether the user is already root or not before running these processses, we will look into that a bit later when we do the code review.

Okay, so let us start first with the `-modulepath` and what this argument actually does which is going to help us understand how we actually exploit this vulnerability. All the `-modulepath` argument does is allow us to set a directory to search for Xorg server modules (I know you're already thinking about how this can be exploited and why it's bad to allow such a function to a user who isn't root). Now, as we mentioned earlier this argument is a privileged process, so imagine if we could set this to an insecure path? Well, we can! From there we can get the process to run code that is unprivileged but as we said, it's running a privileged process!



argument and break down what is happening; in short, it allows us to inject arbitary code into the process which we can then use to gain root.

### Code Review

### Exploit

#### Manual Exploitation

#### Metasploit Exploitation

### Python Exploitation

### References
