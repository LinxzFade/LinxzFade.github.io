---
layout: post
title:  "Xorg CVE2018-14665"
categories: [Vulnerabilities]
tags: [priv esc, exploit]
draft: true
---

### Introduction

On October 25th 2018 a [post](https://securitytracker.com/id/1041948) was made on SecurityTracker disclosing CVE2018-14665. The interesting thing is this CVE has two bugs in two different arguments. The first is a flaw in the `-modulepath` argument which could lead to arbitary code being executed on the system. The second was a flaw in the `-logfile` arugment which could allowed arbitary files to be deleted on the system, both of these issues were caused by poor command line validation.

### So, how does it work?

It is worth noting that the reason this can be used for privlege escalation is because both of these processes are root processes meaning when they are run they will run as root, this is why it is possible for us to gain root access, the problem was that the program was not correctly checking whether the user is already root or not before running these processses, we will look into that a bit later when we do the code review.

Okay, so let us start first with the `-modulepath` and what this argument actually does which is going to help us understand how we actually exploit this vulnerability. All the `-modulepath` argument does is allow us to set a directory to search for Xorg server modules (I know you're already thinking about how this can be exploited and why it's bad to allow such a function to a user who isn't root). Now, as we mentioned earlier this argument is a privileged process, so imagine if we could set this to an insecure path? Well, we can! From there we can get the process to run code that is unprivileged but as we said, it's running a privileged process!

So what about the `-logfile` arguemnt? All this does is set a new log file for the Xorg server instead of using the default log file that is found in `/var/log`. You're probably wondering how we can exploit this? Well this will actually allow us to overwrite files such as `/etc/shadow` if we can overwrite this file then there is a massive problem, for example we could allow the root user to login without authentication taking place! Much like the `-modulepath` flag, `-logfile` is also a privileged process, hence why it is a problem that an unprivileged user can use this switch!


### Code Review

### References
