---
layout: post
title:  "An Introduction to Historical Ciphers II"
categories: [Cryptography Ground Up]
tags: [crypto]
draft: true
---


### Affine Cipher

The Affine cipher is a little bit different to your typical Monoalphabetic Substitution cipher which is why I thought I would explain it a little more in this blog post. So,what is the Affine cipher? Well, the Affine cipher is a Monoalphabetic Substitution cipher whereby each letter in some alphabet is mapped to it's numeric equivalent using a simple math function. I'm going to do my best to explain this as simply as I can as there is a little bit of math here.

#### Encryption

1. We need to select an alphabet in our case we will choose English which will give us the value 26.
2. We will put this value inside a variable $ m $ and we will map this as $ 0 \; \text{to} \;  m - 1 $.
3. We must decide on a value for $ a $ and a value for $ b $. Now, to get a value of $ a $ it must be coprime with $ m $, in our case it needs to be coprime of 26 as $ m $ stores the size of our alphabet and our alphabet is 26 characters. Because $ a $ has this restriction that it must be coprime with $ m $ in our case we can only choose between the following values $ 1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25 $.
4. We must also decide on a value for $ b $ however, there is no restriction on what our $ b $ can hold as long as $ a $ is not equal to 1 as that is our shift.
5. For each plaintext letter we will perform $ E_k(p) ≡ (a \cdot p + b) \bmod m $ which will give us our resulting cipher text, lets look at an example below.

We first need to choose an alphabet, in this case we're going to choose the English alphabet. We will take the size of the alphabet and store it in $ m $. We will then map these in a range of $ 0 \; \text{to} \; m - 1 $ we then need to perform the encryption, so we'll get the below.

```
A B C D E F G H I J K  L  M  N  O  P  Q  R  X  T  U  V  W  X  Y  Z
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
```

$$ E_k(p) ≡ (a \cdot p + b) \bmod m $$

So, let's take a look at the above encryption function in a little bit more detail. Firstly we have the encryption function that is $ E_k(p) $ where `E` is the function and `p` is our input/plaintext. Moving on we can see that we take `a` which is a key (that must be coprime to m) we then multiply that with `p` which is our input we then add `b` which is another key and we do the whole thing modulo `m` which is the size of the alphabet in our case 26.

Let's look at an example for encryption where our plain text is $ p = \text{AFFINECIPHER} $ and our $ a = 5 \; \& \; b = 8 $ we will map the plaintext in the below table.

P                               | A  | F  | F  | I  | N  | E  | C  | I  | P  | H  | E  | R  |
--------------------------------|----|----|----|----|----|----|----|----|----|----|----|----|
$ \mathcal p $                  | 0  | 5  | 5  | 8  | 13 | 4  | 2  | 8  | 15 | 7  | 4  | 17 |
$ (5 \cdot p + 8) $             | 8  | 33 | 33 | 48 | 73 | 28 | 18 | 48 | 83 | 43 | 28 | 93 |
$ (5 \cdot p + 8) \bmod 26 $    | 8  | 7  | 7  | 22 | 21 | 2  | 18 | 22 | 5  | 17 | 2  | 15 |
$ \mathcal C $                  | I  | H  | H  | W  | V  | C  | S  | W  | F  | R  |  C | P  |

Don't worry if the table does not make sense! I'll explain it now. So, firstly we map all letters $ \text{p} $ to their position in the alphabet starting from 0, i.e - $ a = 0, \; b = 1, \; c = 2, \cdots, m-1 $ (this is where our range $ 0 \; to \; m-1 $ plays its part). Next we compute our $ a \cdot p + b $ that we talked about earlier in the encryption function, in our case we said $ a = 5, \; b = 8 $ So what we do is 5 times their current position, e.g if $ F = 5 $ then $ 5 \cdot 5 = 25 $ then we just add eight so $ 25 + 8 = 33 $.

Finally we take the result and we do$ \bmod 26 $ so for example, $ 33 \bmod 26 = 7 $ and so on,finally we map that to the new position in the alphabet, for example $ F ≡ H $ because $ H $ is the 7th letter in the alphabet and $ 33 \bmod26 = 7 $. See that was not so hard, was it? Remember, we need to do this for all the letters but for each letter the exact same steps apply.

You might be thinking - that's great! But how do we decrypt? Well, I'll show you now! If you did not already guess it involves some maths but I promise, it is not that hard!

#### Decryption

Based on the above encryption example we're now going to show you how we would decrypt an Affine cipher, it's pretty easy!